<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Mural de Parcerias</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #0f172a;
    color: #fff;
    display: flex;
    justify-content: center;
}

.container {
    background: #020617;
    width: 100%;
    max-width: 750px;
    margin: 20px;
    padding: 20px;
    border-radius: 10px;
}

h2 {
    text-align: center;
}

.controls {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
}

.controls input,
.controls select {
    flex: 1;
    padding: 8px;
    background: #020617;
    color: #fff;
    border: 1px solid #334155;
    border-radius: 6px;
}

table {
    width: 100%;
    border-collapse: collapse;
}

th, td {
    border: 1px solid #334155;
    padding: 8px;
    text-align: center;
}

th {
    background: #020617;
}

button {
    padding: 6px 10px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-weight: bold;
}

.add-btn {
    background: #2563eb;
    color: #fff;
}

.del-btn {
    background: #dc2626;
    color: #fff;
}

.form {
    margin-top: 20px;
    border-top: 1px solid #334155;
    padding-top: 15px;
}

input, select {
    width: 100%;
    padding: 8px;
    margin-top: 8px;
    background: #020617;
    color: #fff;
    border: 1px solid #334155;
    border-radius: 6px;
}
</style>
</head>
<body>

<div class="container">
<h2>üìã Mural de Parcerias</h2>

<div class="controls">
    <input type="text" id="busca" placeholder="Buscar por nome" oninput="render()">
    <select id="filtro" onchange="render()">
        <option value="">Todas</option>
        <option value="PM">PM</option>
        <option value="PRF">PRF</option>
        <option value="Parceria">Parceria</option>
    </select>
</div>

<table>
<thead>
<tr>
    <th>Nome</th>
    <th>Parceria</th>
    <th>A√ß√£o</th>
</tr>
</thead>
<tbody id="lista"></tbody>
</table>

<div class="form">
<h3>Adicionar (senha obrigat√≥ria)</h3>

<input type="password" id="senha" placeholder="Senha admin">
<input type="text" id="nome" placeholder="Nome">
<select id="parceria">
    <option value="">Selecione</option>
    <option value="PM">PM</option>
    <option value="PRF">PRF</option>
    <option value="Parceria">Parceria</option>
</select>
<button class="add-btn" onclick="adicionar()">Adicionar</button>
</div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
  getFirestore,
  collection,
  addDoc,
  getDocs,
  deleteDoc,
  doc
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCWy_SS9eOJq23sWCGWNvq9Tlk_XXvixoo",
  authDomain: "parceria-cc577.firebaseapp.com",
  projectId: "parceria-cc577",
  storageBucket: "parceria-cc577.firebasestorage.app",
  messagingSenderId: "48532625032",
  appId: "1:48532625032:web:b10581a2a533737f7f713d"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const SENHA_ADMIN = "admin123";
let dados = [];

/* üîÑ CARREGAR */
async function carregar() {
    dados = [];
    const snap = await getDocs(collection(db, "parcerias"));
    snap.forEach(d => dados.push({ id: d.id, ...d.data() }));
    render();
}

/* üéØ FILTRO + BUSCA */
window.render = function () {
    const lista = document.getElementById("lista");
    lista.innerHTML = "";

    const busca = document.getElementById("busca").value.toLowerCase();
    const filtro = document.getElementById("filtro").value;

    dados
    .filter(d =>
        d.nome.toLowerCase().includes(busca) &&
        (filtro === "" || d.parceria === filtro)
    )
    .forEach(d => {
        lista.innerHTML += `
        <tr>
            <td>${d.nome}</td>
            <td>${d.parceria}</td>
            <td>
                <button class="del-btn" onclick="remover('${d.id}')">üóëÔ∏è</button>
            </td>
        </tr>`;
    });
};

/* ‚ûï ADICIONAR (ANTI DUPLICADO) */
window.adicionar = async function () {
    const senha = document.getElementById("senha").value;
    const nome = document.getElementById("nome").value.trim();
    const parceria = document.getElementById("parceria").value;

    if (senha !== SENHA_ADMIN) return alert("Senha incorreta");
    if (!nome || !parceria) return alert("Preencha tudo");

    if (dados.some(d => d.nome.toLowerCase() === nome.toLowerCase())) {
        return alert("Nome j√° existe");
    }

    await addDoc(collection(db, "parcerias"), { nome, parceria });

    document.getElementById("nome").value = "";
    document.getElementById("parceria").value = "";
    document.getElementById("senha").value = "";

    carregar();
};

/* üóëÔ∏è REMOVER (ADMIN) */
window.remover = async function (id) {
    const senha = prompt("Senha admin para remover:");
    if (senha !== SENHA_ADMIN) return alert("Senha incorreta");

    await deleteDoc(doc(db, "parcerias", id));
    carregar();
};

carregar();
</script>

</body>
</html>
